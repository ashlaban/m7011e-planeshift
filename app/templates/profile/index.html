{% extends "base.html" %}

{% block css %}
<link rel="stylesheet" type="text/css" href="/static/css/profile/profile-base.css" />
{% endblock css %}

{% block js %}
<script src="/static/js/planeshift-api.js"></script>
<script src="/static/js/planeshift-viewmodel.js"></script>

<script type="text/javascript" charset="utf-8">
	var planeshift_view_model = new PlaneshiftViewModel();

	document.addEventListener('DOMContentLoaded', function () {
		ko.applyBindings(planeshift_view_model);

		var username = '{{user.username}}';
		planeshift_view_model.get_plane_list_for_user(username);
		planeshift_view_model.get_module_list_for_user(username);
	});

</script>
{% endblock %}

{% block content %}
<section class="center-content">
	<div class="form-box rounded center-content">
		<!-- <h1><em>{{user.username}}</em>'s crib</h1> -->
		<p>Welcome to Planeshift. Get a quick overview of what planes you can shift to and what modules you currently own. Be chill, stay cool.</p>
		
		<div class="heading">
			<h2>
				<i class="fa fa-globe" aria-hidden="true"></i>
				<span>Your Planes</span>
			</h2>
			<a href="/planes/create">
				<button class="btn-slim" >
				<i class="fa fa-plus" aria-hidden="true"></i>
				<span>New plane</span>
				</button>
			</a>
		</div>
		<em data-bind="if: plane_list().length==0">No currently active planes.</em>
		<div data-bind="foreach: plane_list()">
			<!-- <a data-bind="attr: { href: '/planes/name/' + name }"> -->
			<li class="module-brief rounded">
				<img data-bind="attr: { src: picture }">
				<span class="description">
					<span class="module-title" data-bind="text: name"></span>
					<!-- <span class="module-desc"  data-bind="text: short_desc"></span> -->
				</span>
				<span class="filler"></span>
				<!-- ko if: is_owner -->
				<button class="btn-slim" data-bind="event: { click: function (data, event) {
					 planeshift_view_model.delete_plane(name);
				}}">
					<i class="fa fa-trash-o" aria-hidden="true" ></i>
					<span>Delete</span>
				</button>
				<!-- /ko -->
				<button class="btn-slim" data-bind="event: { click: function (data, event) {
					 planeshift_view_model.enter_plane(name);
				}}">
					<i class="fa fa-sign-in" aria-hidden="true"></i>
					<span>Enter</span>
				</button>
				<button class="btn-slim" data-bind="event: { click: function (data, event) {
					 planeshift_view_model.leave_plane(name);
				}}">
					<i class="fa fa-sign-out" aria-hidden="true"></i>
					<span>Leave</span>
				</button>
			</li>
			<!-- </a> -->
		</div>

		<div class="heading">
			<h2>
				<i class="fa fa-microchip" aria-hidden="true"></i>
				Your Modules
			</h2>
			<a href="/modules/create">
				<button class="btn-slim">
					<i class="fa fa-plus" aria-hidden="true"></i>
					<span>New module</span>
				</button>
			</a>
		</div>
		<em data-bind="if: module_list().length==0">You have not created any modules.</em>
		<ul data-bind="foreach: module_list">
			<a data-bind="attr: { href: '/modules/name/' + name }">
				<li class="module-brief rounded">
					<img data-bind="attr: { src: picture }">
					<span class="description">
						<span class="module-title" data-bind="text: name"></span>
						<span class="module-desc"  data-bind="text: short_desc"></span>
					</span>
					<span class="filler"></span>
					<button class="btn-slim" data-bind="event: { click: function(data, event) {
						event.stopPropagation();
						var success = planeshift.redirect.to.profile();
						planeshift_view_model.remove_module(name, success);
					}}">
						<i class="fa fa-trash-o" aria-hidden="true"></i>
						<span>Delete</span>
					</button>
					<button class="btn-slim" data-bind="event: { click: function (data, event) {
						event.stopPropagation();
						planeshift.redirect.to.module_new_version(name)();
					}}">
						<i class="fa fa-upload" aria-hidden="true"></i>
						<span>New Version</span>
					</button>
				</li>
			</a>
		</ul>
		

	</div>
</section>

{% endblock %}
